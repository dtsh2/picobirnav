dist.au <- read.csv("http://rosetta.reltech.org/TC/v15/Mapping/data/dist-Aus.csv")
dist.au
3*20*365
0.5*20*365
10*20*365
73kW
library(mgcv)
set.seed(3)
dat <- gamSim(1,n=25000,dist="normal",scale=20)
bs <- "cr";k <- 12
b <- bam(y ~ s(x0,bs=bs)+s(x1,bs=bs)+s(x2,bs=bs,k=k)+
s(x3,bs=bs),data=dat)
summary(b)
plot(b,pages=1,rug=FALSE) ## plot smooths, but not rug
plot(b,pages=1,rug=FALSE,seWithMean=TRUE) ## `with intercept' CIs
ba <- bam(y ~ s(x0,bs=bs,k=k)+s(x1,bs=bs,k=k)+s(x2,bs=bs,k=k)+
s(x3,bs=bs,k=k),data=dat,method="GCV.Cp") ## use GCV
summary(ba)
dim(dat)
head(dat)
n <- 50000 ## simulate n data
dat <- gamSim(1,n=n,dist="binary",scale=.33)
p <- binomial()$linkinv(dat$f-6) ## make 1's rare
dat$y <- rbinom(p,1,p) ## re-simulate rare response
S <- 0.02 ## sampling fraction of zeroes
dat <- dat[dat$y==1 | runif(n) < S,] ## sampling
dat$s <- rep(log(nrow(dat)/n),nrow(dat))
lr.fit <- gam(y~s(x0,bs="cr")+s(x1,bs="cr")+s(x2,bs="cr")+s(x3,bs="cr")+
offset(s),family=binomial,data=dat,method="REML")
op <- par(mfrow=c(2,2))
fn <- c("f0","f1","f2","f3");xn <- c("x0","x1","x2","x3")
for (k in 1:4) {
plot(lr.fit,select=k,scale=0)
ff <- dat[[fn[k]]];xx <- dat[[xn[k]]]
ind <- sort.int(xx,index.return=TRUE)$ix
lines(xx[ind],(ff-mean(ff))[ind]*.33,col=2)
}
par(op)
rm(dat)
181/142*365
rm(list = ls())
library(phytools)
library(ape)
tree1<-read.newick("Picobirnavirus complete.newick")
setwd("~/GitHub/picobirnav")
tree1<-read.newick("Picobirnavirus complete.newick")
tree2<-read.newick("Picobirnavirus short.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
tree1$tip.label<-LETTERS[1:length(tree1$tip.label)]
tree2$tip.label<-LETTERS[tt]
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
pdf("cophy_pico.pdf",width = 7,height = 7)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of NaturePico.newick")
tree2<-read.newick("ML tree of NaturePicoTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
tree1$tip.label<-LETTERS[1:length(tree1$tip.label)]
tree2$tip.label<-LETTERS[tt]
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
dev.off()
dev.off()
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
tree2<-read.newick("ML tree of NaturePicoTrimmed.newick")
tree2$tip.label
tree1<-read.newick("ML tree of NaturePico.newick")
tree2<-read.newick("ML tree of NaturePicoTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
pdf("cophy_pico_nature_trimmed.pdf",width = 7,height = 7)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
source('~/GitHub/picobirnav/cophy_pico.R', echo=TRUE)
rm(list = ls())
library(phytools)
library(ape)
tree1<-read.newick("Picobirnavirus complete.newick")
tree2<-read.newick("Picobirnavirus short.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
tree1$tip.label<-LETTERS[1:length(tree1$tip.label)]
tree2$tip.label<-LETTERS[tt]
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of NaturePico.newick")
tree2<-read.newick("ML tree of NaturePicoTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
tree1$tip.label<-LETTERS[1:length(tree1$tip.label)]
tree2$tip.label<-LETTERS[tt]
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
rm(list = ls())
library(phytools)
library(ape)
tree1<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
tree1$tip.label<-LETTERS[1:length(tree1$tip.label)]
tree2$tip.label<-LETTERS[tt]
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
tt<-charmatch(tree1$tip.label,tree2$tip.label)
tree1<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
tt
tree1
tree1$tip.label
x<-tree$tip.label
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[3]))
x1
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
x1
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
x1
tree1<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[3]))
x1
tree1<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[3]))
x1
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
x1
tree1<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[3]))
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[3]))
x1
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[3]))
tree1$tip.label<-x1
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[3]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
?cophylo
obj<-cophylo(tree1,tree2,assoc=tt,rotate = F)
plot(tree1)
plot(tree2)
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[3]))
tree2$tip.label<-x1
plot(tree2)
tree1<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[3]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[3]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
dim(tree1)
dim(tree2)
str(tree2)
str(tree1)
tree1<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of ProteinAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of ProteinAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
x
x<-tree1$tip.label
x
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x
x<-tree2$tip.label
x
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
plot(tree2)
plot(tree1)
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[3:5]))
tree1$tip.label<-x1
plot(tree1)
tree1$tip.label<-x1
tree1
plot(tree1)
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[c(3,4,5)]))
tree1$tip.label<-x1
plot(tree1)
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[c(3,4,5)]))
tree1$tip.label<-x1
plot(tree1)
(tree1)
rm(list = ls())
library(phytools)
library(ape)
tree1<-read.newick("Picobirnavirus complete.newick")
tree2<-read.newick("Picobirnavirus short.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
tree1$tip.label<-LETTERS[1:length(tree1$tip.label)]
tree2$tip.label<-LETTERS[tt]
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of NaturePico.newick")
tree2<-read.newick("ML tree of NaturePicoTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
tree1$tip.label<-LETTERS[1:length(tree1$tip.label)]
tree2$tip.label<-LETTERS[tt]
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of ProteinAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[2]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of ProteinAlignmentTrimmed.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
rm(list = ls())
library(phytools)
library(ape)
tree1<-read.newick("Picobirnavirus complete.newick")
tree2<-read.newick("Picobirnavirus short.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
tree1$tip.label<-LETTERS[1:length(tree1$tip.label)]
tree2$tip.label<-LETTERS[tt]
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
obj
dev.off()
tree1<-read.newick("ML tree of NaturePico.newick")
tree2<-read.newick("ML tree of NaturePicoTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
tree1$tip.label<-LETTERS[1:length(tree1$tip.label)]
tree2$tip.label<-LETTERS[tt]
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of ProteinAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of ProteinAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
tree1<-read.newick("ML tree of ProteinAlignmentTrimmed.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
obj<-cophylo(tree1,tree2,rotate = T)
plot(obj,cex=0.01)
dev.off()
source('~/GitHub/picobirnav/cophy_pico.R', echo=TRUE)
rm(list = ls())
library(phytools)
library(ape)
tree1<-read.newick("Picobirnavirus complete.newick")
tree2<-read.newick("Picobirnavirus short.newick")
plot(tree1)
tree1<-read.newick("ML tree of NaturePico.newick")
plot(tree1)
tree1<-read.newick("ML tree of NucleotideAlignmentTrimmedSHORT.newick")
tree2<-read.newick("ML tree of NucleotideAlignmentTrimmed.newick")
tt<-charmatch(tree1$tip.label,tree2$tip.label)
x<-tree1$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree1$tip.label<-x1
x<-tree2$tip.label
x1 = sapply(strsplit(x, split='_', fixed=TRUE),function(x) (x[1]))
tree2$tip.label<-x1
obj<-cophylo(tree1,tree2,rotate = F)
plot(obj,cex=0.01)
